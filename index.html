<!DOCTYPE HTML>

<html>
    <head>
        <meta charset="utf-8">
	    <meta charset="UTF-8">
          <meta property="og:site_name" content="mcprofile.github.io">
      <meta property="og:title" content="MCProfile Lookup">
      <meta name="description" content="Easy to use MC profile viewer.">
      <meta property="og:description" content="Easy to use MC profile viewer.">
      <meta property="og:url" content="https://mcprofile.github.io/?ranc">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://mcuserna.me/assets/js/skinview3d.bundle.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <title>Placeholder</title>
<style>

.flex-container {
    display: flex;
}

.flex-child {
    flex: 1;
    text-align: center;
    
}  

.flex-child:first-child {
    
} 

    </style>
            
    </head>

    <body onload="getinfo()" style="background-color:#1a1a1a">
        <div style="text-align:center">
        <input onkeydown="searchfrominput()" id="searchbar" style="border:none; border-radius:5px;outline:none;background-color:#262626;color:white;font-family:'Segoe UI'; height:25px; width:300px;" placeholder="Search a user or UUID..." type="text"></input>
        <button onclick="search()" style="margin:5px;height:27px;cursor:pointer; width:40px;background-color:#262626; border-radius:5px; border:none"><i style="color:white" class="fa fa-search"></i></button>
        </div><br>
        <div class="flex-container">
        <div class="flex-child">
            <label id="username" style="font-family:'Segoe UI'; color:white; font-size:42px"></label><br><br>
            <canvas style="border: 2px solid #262626; border-radius:20px; cursor:all-scroll;  background-image: url(https://i.imgur.com/rrBuoUM.png);" id="skin_container"></canvas><br><br>
	    <input type="checkbox" id="test" name="test">
            <label for="test">Cape</label>
            <button id="downloadbutton" style="border: none; cursor:pointer; border-radius:10px; background-color:#262626; color:white; width:245px; height:30px; font-family:'Segoe UI'; font-size:14px;" onclick="download()"><i style="color:white" class="fa fa-download"></i> Download Skin</button>
            <button id="applybutton" style="border: none; margin:5px; cursor:pointer; border-radius:10px; background-color:#262626; color:white; width:245px; height:30px; font-family:'Segoe UI'; font-size:14px;" onclick="apply()"><i style="color:white" class="fa fa-share"></i> Apply To Account</button>

        </div>
        <div class="flex-child" >
            <label id="historylabel" style="font-family:'Segoe UI'; color:white; font-size:25px"><b>History</b></label><br>
            <label id="history" style="font-family:'Segoe UI'; color:white; font-size:18px"></label><br><br><br>
	    <label id="hypixel" style="font-family:'Segoe UI'; color:white; font-size:25px"><b>Hypixel Stats</b></label><br>
            <label id="stats" style="font-family:'Segoe UI'; color:white; font-size:18px"></label>
        </div>
         <div class="flex-child" >
            <label id="UUIDlabel" style="font-family:'Segoe UI'; color:white; font-size:25px"><b>UUID</b></label><br>
            <label id="uuid" style="font-family:'Segoe UI'; color:white; font-size:18px"></label><br><br><br>
            <label id="linkslabel" style="font-family:'Segoe UI'; color:white; font-size:25px"><b>Links</b></label><br>
            <label id="links" style="font-family:'Segoe UI'; color:white; font-size:18px"></label>
        </div>
        </div>
                    

 <script>



    let result = "";
    let counter = 0;
    //variables set for name history later on
async function getinfo(){

let url = window.location.href;
var segments = url.split('?'); //gets the name from the url

document.getElementById("searchbar").value = segments[1];
    let skinViewer = new skinview3d.SkinViewer({
		canvas: document.getElementById("skin_container"),
		width: 240,
		height: 355,
		skin: "https://minotar.net/skin/MHF_Steve" // placeholder skin
	});

    let control = skinview3d.createOrbitControls(skinViewer);
	control.enableRotate = true;
	control.enableZoom = false;
	control.enablePan = false;

    let walk = skinViewer.animations.add(skinview3d.WalkingAnimation);
    walk.speed = 0.5 //animations for 3d skin viewer



let response = await fetch("https://api.ashcon.app/mojang/v2/user/" + segments[1]);
const json = await response.json(); //fetches info from api
if(response.status == 404)
{
    document.getElementById("username").style.visibility = "hidden";
 document.getElementById("uuid").style.visibility = "hidden";
 document.getElementById("links").style.visibility = "hidden";
 document.getElementById("skin_container").style.visibility = "hidden";
 document.getElementById("UUIDlabel").style.visibility = "hidden";
 document.getElementById("linkslabel").style.visibility = "hidden";
 document.getElementById("downloadbutton").style.visibility = "hidden";
 document.getElementById("applybutton").style.visibility = "hidden";
 document.getElementById("hypixel").style.visibility = "hidden";
 document.getElementById("historylabel").innerHTML = "<b>404</b>";
 document.getElementById("history").innerHTML = "User not found.";
 document.title = "404 | MCProfile"
	
	//404 message page if user does not exist

}
 
	
	
	var link = document.querySelector("link[rel~='icon']");
if (!link) {
    link = document.createElement('link');
    link.rel = 'icon';
    document.getElementsByTagName('head')[0].appendChild(link);
}
link.href = 'https://crafatar.com/avatars/' + json.uuid; //sets the icon in the tab area to the head of the users skin
	
 var name = json.username;
 skinViewer.loadSkin("https://crafatar.com/skins/" + json.uuid); //loads users actual skin onto the 3d render, replaces the placeholder skin from earlier
 if(name == "Ranc")
 {
   document.getElementById("username").style.fontFamily = "Comic Sans MS";
   name = "<font color=\"#a33131\">[</font>OWNER<font color=\"#a33131\">]</font>" + " RancðŸ˜Ž"
   skinViewer.loadCape("https://i.imgur.com/hf9hNJL.png");
	 // if username is creators name, set the username label to [OWNER] rank and load custom cape to model
   
 }
 if(name == "RaheemSterling")
 {
   name = "<font color=\"#cc0202\">[</font>OppChinga<font color=\"#cc0202\">]</font>" + " RaheemSterling"
   skinViewer.loadCape("https://i.imgur.com/hf9hNJL.png");
	 // if username is friends name, also load custom cape to model
 }
 
 skinViewer.loadCape("https://crafatar.com/capes/" + json.uuid); //if user has a cape, load it onto the model
document.title = json.username + " | MCProfile"; // set title of document to users name
document.getElementById("username").innerHTML = "<b>" + name + "</b>"; // sets username label to name
const history = [];
const changedat = []; // arrays for name history
let names = json.username_history;
for(var i=0; i< names.length;i++){
        history.push(names[i]['username']);
        changedat.push(names[i]['changed_at']);       
    } // loops through json and adds previous names and change dates to respective arrays


    
history.forEach((num1, index) => {
  const num2 = changedat[index]
  counter++; // adds numbers to each name 
  let test = "";
  if(num2 == undefined)
  {
     test = "(Original Name)"
  }
  else
  {
      test = num2.replace(/T/g, ' ').replace(/Z/g, ' ').replace(/-/g, '/')
      test = test.substring(0, test.length - 5);
      
  }
  result = result + counter + ". <b>" + "<a style=\"color:white\" href=" + "https://mcprofile.github.io/?" + num1 + ">" + num1 + "</a>" + "</b> / <i>" + test + "</i><br>";
	
	// formats the name history to do things such as making the change dates more readable and making each name a hyperlink to its respective mcprofile link and sets it to the result variable defined at the beginning of the function
});

document.getElementById("history").innerHTML = result + "<br><i>(In order of oldest to newest)</i>"; // sets the text of the name history label to the formatted name history created above and also adds extra text showing what order the history is in
document.getElementById("uuid").innerHTML = json.uuid + "<br>" + json.uuid.replace(/-/g, '') // sets the uuid label to the spaces uuid and unspaces variant
document.getElementById("links").innerHTML = "<b>NameMC: </b>" + "<a style=\"color:#cccccc\" href=" + "https://namemc.com/" + json.username + ">" + "namemc.com/" + json.username + "</a><br>" + "<b>MCProfile: </b>" + "<a style=\"color:#cccccc\" href=" + "https://mcprofile.github.io/?" + json.username + ">" + "mcprofile.github.io/?" + json.username + "</a>" + "<br><b>mcusername: </b>" + "<a style=\"color:#cccccc\" href=" + "https://mcuserna.me/?lookup=" + json.username + ">" + "mcuserna.me/?lookup=?" + json.username + "</a>"
// sets the links label text to all of the other minecraft name searching websites
	
		 let hypixelresponse = await fetch("https://api.hypixel.net/player?uuid=" + json.uuid + "&key=2b521465-cb27-4692-90a6-6ff341eb068a");
const hypixeljson = await hypixelresponse.json();
if(hypixeljson.player == null)
{
document.getElementById("stats").innerHTML = "<b>" + json.username + "</b> has never joined hypixel."
}
var lastloginformatted = "";
var firstloginformatted = "";
var lastlogintimestamp = hypixeljson.player.lastLogin
var lastlogindate = new Date(lastlogintimestamp);
let lastloginyear = lastlogindate.getFullYear();
let lastloginday = ("0" + lastlogindate.getDate()).slice(-2);
let lastloginmonth = ("0" + (lastlogindate.getMonth() + 1)).slice(-2);
let lastloginhours = lastlogindate.getHours();
let lastloginminutes = lastlogindate.getMinutes();
let lastloginseconds = lastlogindate.getSeconds();
if(lastloginseconds < 10)
{
    lastloginseconds = "0" + lastloginseconds
}
if(lastloginminutes < 10)
{
    lastloginminutes = "0" + lastloginminutes
}
if(lastloginhours < 10)
{
    lastloginhours = "0" + lastloginhours
}

lastloginformatted = lastloginyear + "/" + lastloginmonth + "/" + lastloginday + " " + lastloginhours + ":" + lastloginminutes + ":" + lastloginseconds;


var firstlogintimestamp = hypixeljson.player.firstLogin
var firstlogindate = new Date(firstlogintimestamp);
let firstloginyear = firstlogindate.getFullYear();
let firstloginday = ("0" + firstlogindate.getDate()).slice(-2);
let firstloginmonth = ("0" + (firstlogindate.getMonth() + 1)).slice(-2);
let firstloginhours = firstlogindate.getHours();
let firstloginminutes = firstlogindate.getMinutes();
let firstloginseconds = firstlogindate.getSeconds();
if(firstloginseconds < 10)
{
    firstloginseconds = "0" + firstloginseconds
}
if(firstloginminutes < 10)
{
    firstloginminutes = "0" + firstloginminutes
}
if(firstloginhours < 10)
{
    firstloginhours = "0" + firstloginhours
}
	
firstloginformatted = firstloginyear + "/" + firstloginmonth + "/" + firstloginday + " " + firstloginhours + ":" + firstloginminutes + ":" + firstloginseconds;



if(firstlogintimestamp == undefined)
{
    firstloginformatted = "Unknown"
}

if(lastlogintimestamp == undefined)
{
    lastloginformatted = "Unknown"
}
	

	
document.getElementById("stats").innerHTML = "First Login: <b>" + firstloginformatted + "</b></br> Last Login: <b>" + lastloginformatted + "</b><br>Last Played Game: <b>" + hypixeljson.player.mostRecentGameType + "</b>"
}

function download(){
    
let url = window.location.href;
var segments = url.split('?');
    window.location.href = "https://minotar.net/download/" + segments[1]; // redirects to the skin download page
}

function apply(){

    let url = window.location.href;
var segments = url.split('?');
    window.location.href = "https://www.minecraft.net/en-us/profile/skin/remote?url=https://minotar.net/skin/" + segments[1]; // redirects to the minecraft skin change website with skin of user


}

function search(){
    window.location.href = "https://mcprofile.github.io/?" + document.getElementById("searchbar").value // search function changes the url, which triggers the info function above
}

function searchfrominput(){
     if (event.keyCode === 13) {
    window.location.href = "https://mcprofile.github.io/?" + document.getElementById("searchbar").value // allows for the enter key to be pressed to search
     }
}
         
        </script>

        
    </body>

</html>
